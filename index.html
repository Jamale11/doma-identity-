<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Doma ID Generator</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    body {
      background: linear-gradient(135deg, #1e3a8a, #2563eb, #3b82f6);
    }
    canvas {
      border: 4px solid #3b82f6;
      border-radius: 16px;
      box-shadow: 0px 6px 16px rgba(0,0,0,0.4);
    }
  </style>
</head>
<body class="flex flex-col items-center justify-center min-h-screen p-6 text-white">

  <h1 class="text-3xl font-extrabold mb-6 drop-shadow-lg">‚ú® Doma ID Card Generator</h1>

  <div class="bg-white text-gray-800 p-6 rounded-2xl shadow-2xl w-full max-w-md mb-6 space-y-4">
    
    <!-- Nama -->
    <div>
      <label class="block mb-1 font-semibold text-blue-700">Name:</label>
      <input id="nameInput" type="text" placeholder="Enter name" 
             class="w-full p-2 border rounded focus:ring-2 focus:ring-blue-400">
    </div>

    <!-- Your ID -->
    <div>
      <label class="block mb-1 font-semibold text-blue-700">Your ID:</label>
      <input id="idInput" type="text" placeholder="Enter ID (ex: user123)" 
             class="w-full p-2 border rounded focus:ring-2 focus:ring-blue-400">
    </div>

    <!-- Profile Link -->
    <div>
      <label class="block mb-1 font-semibold text-blue-700">Profile Link:</label>
      <input id="linkInput" type="text" placeholder="https://example.com" 
             class="w-full p-2 border rounded focus:ring-2 focus:ring-blue-400">
    </div>

    <!-- Upload Avatar -->
    <div>
      <label class="block mb-1 font-semibold text-blue-700">Upload Avatar / Logo:</label>
      <label class="flex items-center justify-center px-4 py-2 bg-blue-600 text-white rounded-lg cursor-pointer hover:bg-blue-700">
        Choose File
        <input id="avatarInput" type="file" accept="image/*" class="hidden">
      </label>
      <span id="avatarFileName" class="ml-2 text-sm text-gray-600">No file chosen</span>
    </div>

    <!-- Tombol -->
    <div class="space-y-2 pt-2">
      <button onclick="generateID()" 
              class="w-full bg-blue-600 hover:bg-blue-700 text-white font-bold px-4 py-2 rounded-lg">
        üé® Generate ID Card
      </button>
      <button onclick="downloadID()" 
              class="w-full bg-yellow-400 hover:bg-yellow-500 text-black font-bold px-4 py-2 rounded-lg">
        ‚¨áÔ∏è Download ID Card
      </button>
    </div>
  </div>

  <canvas id="idCanvas" width="500" height="300"></canvas>

  <!-- QRCode.js -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"></script>

  <script>
    const canvas = document.getElementById("idCanvas");
    const ctx = canvas.getContext("2d");

    let avatarImg = null;

    // Avatar input
    document.getElementById("avatarInput").addEventListener("change", function(e) {
      const fileName = e.target.files.length > 0 ? e.target.files[0].name : "No file chosen";
      document.getElementById("avatarFileName").textContent = fileName;

      const reader = new FileReader();
      reader.onload = function(event) {
        avatarImg = new Image();
        avatarImg.src = event.target.result;
      }
      if(e.target.files[0]) reader.readAsDataURL(e.target.files[0]);
    });

    function generateID() {
      const name = document.getElementById("nameInput").value || "Anonymous";
      const userId = document.getElementById("idInput").value || "ID-0000";
      const link = document.getElementById("linkInput").value || "https://rialo.fun";

      // Clear canvas
      ctx.clearRect(0, 0, canvas.width, canvas.height);

      // Fixed Background
      const gradient = ctx.createLinearGradient(0, 0, canvas.width, canvas.height);
      gradient.addColorStop(0, "#1e3a8a");
      gradient.addColorStop(1, "#2563eb");
      ctx.fillStyle = gradient;
      ctx.fillRect(0, 0, canvas.width, canvas.height);

      // Semi-transparent overlay
      ctx.fillStyle = "rgba(0,0,0,0.35)";
      ctx.fillRect(0, 0, canvas.width, canvas.height);

      // Title
      ctx.fillStyle = "gold";
      ctx.font = "bold 28px Arial";
      ctx.fillText("DOMA ID CARD", 160, 50);

      // Avatar / Logo
      if (avatarImg) {
        ctx.save();
        ctx.beginPath();
        ctx.arc(80, 130, 50, 0, Math.PI * 2, true);
        ctx.closePath();
        ctx.clip();
        ctx.drawImage(avatarImg, 30, 80, 100, 100);
        ctx.restore();
      } else {
        ctx.fillStyle = "#fff";
        ctx.beginPath();
        ctx.arc(80, 130, 50, 0, Math.PI * 2, true);
        ctx.fill();
      }

      // Name & ID
      ctx.fillStyle = "white";
      ctx.font = "bold 22px Arial";
      ctx.fillText(name, 160, 120);

      ctx.fillStyle = "#facc15";
      ctx.font = "18px Arial";
      ctx.fillText(userId, 160, 150);

      // Footer
      ctx.fillStyle = "white";
      ctx.font = "14px Arial";
      ctx.fillText("For Fun ‚Ä¢ Doma Community", 160, 190);

      // Generate QR to temp canvas
      let qrCanvas = document.createElement("div");
      let qrCode = new QRCode(qrCanvas, {
        text: link,
        width: 80,
        height: 80,
        colorDark: "#000000",
        colorLight: "#ffffff"
      });

      // Wait for QR to render
      setTimeout(() => {
        let qrImg = qrCanvas.querySelector("img");
        if (qrImg) {
          let tempImg = new Image();
          tempImg.src = qrImg.src;
          tempImg.onload = function() {
            ctx.drawImage(tempImg, canvas.width - 100, canvas.height - 100, 80, 80);
          };
        }
      }, 500);
    }

    function downloadID() {
      const link = document.createElement("a");
      link.download = "doma-id-card.png";
      link.href = canvas.toDataURL();
      link.click();
    }
  </script>
</body>
</html>
